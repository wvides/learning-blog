---
import HeaderLink from './HeaderLink.astro';
---

<header class="site-header">
	<nav aria-label="Primary">
		<div class="menu-shell">
			<div class="nav-links">
				<HeaderLink href="/">Home</HeaderLink>
				<HeaderLink href="/blog">Articles</HeaderLink>
				<HeaderLink href="/now">Notes</HeaderLink>
				<HeaderLink href="/uses">Work</HeaderLink>
				<HeaderLink href="/about">About</HeaderLink>
			</div>
			<span class="menu-divider" aria-hidden="true"></span>
			<HeaderLink href="/tags">Tags</HeaderLink>
			<button
				type="button"
				class="theme-toggle"
				aria-label="Switch to dark theme"
				aria-pressed="false"
				data-theme-toggle
			>
				<span aria-hidden="true" data-theme-icon>◑</span>
			</button>
		</div>
	</nav>
</header>

<script is:inline>
	(() => {
		const key = 'learning-blog-theme';
		const root = document.documentElement;
		const button = document.querySelector('[data-theme-toggle]');
		const icon = document.querySelector('[data-theme-icon]');
		if (!button || !icon) return;

		const sync = (theme) => {
			root.dataset.theme = theme;
			const darkMode = theme === 'dark';
			button.setAttribute('aria-pressed', String(darkMode));
			button.setAttribute('aria-label', darkMode ? 'Switch to light theme' : 'Switch to dark theme');
			icon.textContent = darkMode ? '☀' : '◑';
		};

		const current = root.dataset.theme === 'dark' ? 'dark' : 'light';
		sync(current);

		button.addEventListener('click', () => {
			const next = root.dataset.theme === 'dark' ? 'light' : 'dark';
			sync(next);
			try {
				localStorage.setItem(key, next);
			} catch (_) {}
		});
	})();
</script>

<style>
	.site-header {
		padding: 0.95rem 1.25rem;
		border-bottom: 1px solid var(--line-subtle);
		background: color-mix(in srgb, var(--panel-bg), white 26%);
	}

	:root[data-theme="dark"] .site-header {
		background: color-mix(in srgb, var(--panel-bg), #0c3c45 36%);
	}

	nav {
		width: min(960px, calc(100% - 0.75rem));
		margin: 0 auto;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.75rem;
	}

	.menu-shell {
		display: inline-flex;
		align-items: center;
		gap: 0.25rem;
		padding: 0.28rem;
		border-radius: 999px;
		border: 1px solid color-mix(in srgb, var(--line-subtle), white 22%);
		background: color-mix(in srgb, var(--panel-bg), white 46%);
		box-shadow:
			0 1px 1px rgba(8, 47, 55, 0.08),
			0 10px 24px rgba(8, 47, 55, 0.12);
	}

	:root[data-theme="dark"] .menu-shell {
		border-color: color-mix(in srgb, var(--line-subtle), white 10%);
		background: color-mix(in srgb, var(--panel-bg), #174852 42%);
		box-shadow:
			0 1px 1px rgba(0, 0, 0, 0.22),
			0 10px 24px rgba(0, 0, 0, 0.26);
	}

	.nav-links {
		display: inline-flex;
		align-items: center;
		gap: 0.08rem;
	}

	.menu-divider {
		width: 1px;
		height: 1.1rem;
		background: color-mix(in srgb, var(--line-subtle), var(--text-strong) 8%);
	}

	.theme-toggle {
		border: 0;
		background: transparent;
		color: var(--text-strong);
		font: inherit;
		padding: 0.42rem 0.56rem;
		border-radius: 999px;
		cursor: pointer;
		opacity: 0.9;
		font-size: 0.8rem;
		line-height: 1;
	}

	.theme-toggle:hover {
		opacity: 1;
		background: color-mix(in srgb, var(--line-subtle), transparent 52%);
	}

	@media (max-width: 720px) {
		.site-header {
			padding: 0.75rem 0.65rem;
		}

		nav {
			width: calc(100% - 0.2rem);
			align-items: flex-start;
			flex-direction: column;
		}

		.menu-shell {
			width: 100%;
			max-width: 100%;
			overflow-x: auto;
		}
	}
</style>
