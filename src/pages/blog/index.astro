---
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';
import SiteShell from '../../layouts/SiteShell.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<SiteShell title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<section class="blog-list">
		<h1>All Posts</h1>
		<ul>
			{
				posts.map((post) => (
					<li>
						<a href={`/blog/${post.id}/`} class="post-link">
							<h3>{post.data.title}</h3>
							<p>{post.data.description}</p>
							<small>
								<FormattedDate date={post.data.pubDate} />
							</small>
						</a>
					</li>
				))
			}
		</ul>
	</section>
</SiteShell>

<style>
	.blog-list h1 {
		margin-bottom: var(--space-5);
	}

	.blog-list ul {
		list-style: none;
		padding: 0;
		margin: 0;
		display: grid;
		gap: var(--space-4);
	}

	.post-link {
		display: block;
		padding: var(--space-5);
		border: 1px solid var(--line-subtle);
		border-radius: var(--radius-md);
		background: color-mix(in srgb, var(--panel-bg), white 20%);
		text-decoration: none;
	}

	.post-link h3 {
		margin-bottom: var(--space-2);
	}

	.post-link p {
		margin-bottom: var(--space-3);
	}

	.post-link small {
		color: var(--text-muted);
	}

	.post-link:hover {
		border-color: color-mix(in srgb, var(--link), white 45%);
		box-shadow: 0 12px 30px rgba(14, 64, 73, 0.08);
	}
</style>
