---
import type { CollectionEntry } from 'astro:content';
import FormattedDate from '../components/FormattedDate.astro';
import { withBase } from '../lib/paths';
import { tagToSlug } from '../lib/tags';
import SiteShell from './SiteShell.astro';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, tags = [] } = Astro.props;
---

<SiteShell title={title} description={description}>
	<article class="post">
		<header class="post-header">
			<div class="post-date">
				<FormattedDate date={pubDate} />
				{
					updatedDate && (
						<span class="updated-on">
							Updated <FormattedDate date={updatedDate} />
						</span>
					)
				}
			</div>
			<h1>{title}</h1>
			<p>{description}</p>
			{
				tags.length > 0 && (
					<ul class="tags">
						{tags.map((tag) => <li><a href={withBase(`/tags/${tagToSlug(tag)}/`)}>{tag}</a></li>)}
					</ul>
				)
			}
		</header>
		<div class="prose">
			<slot />
		</div>
	</article>
</SiteShell>

<style>
	.post {
		max-width: 760px;
		margin: 0 auto;
	}

	.post-header {
		margin-bottom: var(--space-6);
		padding-bottom: var(--space-5);
		border-bottom: 1px solid var(--line-subtle);
	}

	.post-date {
		display: flex;
		flex-wrap: wrap;
		gap: var(--space-3);
		margin-bottom: var(--space-3);
		font-size: 0.92rem;
		color: var(--text-muted);
	}

	.updated-on {
		font-style: italic;
	}

	.post-header h1 {
		margin-bottom: var(--space-3);
	}

	.post-header p {
		margin: 0;
	}

	.tags {
		display: flex;
		flex-wrap: wrap;
		gap: 0.35rem;
		list-style: none;
		margin: var(--space-4) 0 0;
		padding: 0;
	}

	.tags a {
		display: inline-flex;
		padding: 0.2rem 0.5rem;
		border-radius: 999px;
		font-size: 0.76rem;
		background: rgba(25, 32, 33, 0.08);
		text-decoration: none;
		color: var(--text-strong);
	}

	.tags a:hover {
		background: rgba(25, 32, 33, 0.15);
	}

	.prose :global(p) {
		margin-bottom: var(--space-5);
	}
</style>
