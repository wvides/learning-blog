---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { withBase } from '../lib/paths';

interface Props {
	title: string;
	description: string;
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={title} description={description} />
	</head>
	<body>
		<a href="#main-content" class="skip-link">Skip to main content</a>
		<div class="frame">
			<div class="scene" aria-hidden="true">
				<picture class="scene-picture">
					<source
						srcset={`${withBase('/images/site-bg-1200.jpg')} 1200w, ${withBase('/images/site-bg-1800.jpg')} 1800w, ${withBase('/images/site-bg-2400.jpg')} 2400w`}
						sizes="100vw"
					/>
					<img
						class="scene-image"
						src={withBase('/images/site-bg-1800.jpg')}
						alt=""
						width="2400"
						height="1792"
						loading="eager"
						decoding="async"
					/>
				</picture>
			</div>
			<div class="panel">
				<Header />
				<main class="panel-main" id="main-content">
					<slot />
				</main>
				<Footer />
			</div>
		</div>
	</body>
</html>

<style>
	.skip-link {
		position: absolute;
		top: -100%;
		left: 0.75rem;
		padding: 0.6rem 0.8rem;
		border-radius: var(--radius-sm);
		background: #ffffff;
		color: #111;
		text-decoration: none;
		z-index: 1000;
	}

	.skip-link:focus {
		top: 0.75rem;
	}

	.frame {
		position: relative;
		min-height: 100vh;
		padding: clamp(0.9rem, 2.6vw, 2.6rem);
		overflow: hidden;
	}

	.scene {
		position: absolute;
		inset: 0;
		pointer-events: none;
		overflow: hidden;
	}

	.scene-picture,
	.scene-image {
		position: absolute;
		inset: 0;
		width: 100%;
		height: 100%;
	}

	.scene-image {
		object-fit: cover;
		object-position: center 72%;
		opacity: 0.54;
		filter: saturate(0.9) contrast(1.04);
	}

	.scene::before {
		content: "";
		position: absolute;
		inset: 0;
		background:
			radial-gradient(90rem 45rem at 50% -8%, rgba(187, 233, 240, 0.25), transparent 52%),
			linear-gradient(180deg, rgba(8, 53, 62, 0.22), rgba(4, 35, 43, 0.5));
		z-index: 1;
	}

	:root[data-theme="dark"] .scene-image {
		opacity: 0.48;
		filter: saturate(0.82) contrast(1.06) brightness(0.86);
	}

	:root[data-theme="dark"] .scene::before {
		background:
			radial-gradient(90rem 45rem at 50% -8%, rgba(77, 175, 195, 0.18), transparent 56%),
			linear-gradient(180deg, rgba(4, 24, 30, 0.36), rgba(2, 15, 19, 0.7));
	}

	.panel {
		width: min(1220px, 100%);
		margin: 0 auto;
		border-radius: var(--radius-lg);
		border: 3px solid var(--panel-border);
		background: var(--panel-bg);
		box-shadow: var(--shadow-panel);
		overflow: clip;
		position: relative;
		z-index: 2;
	}

	.panel-main {
		width: min(960px, calc(100% - 1.5rem));
		margin: 0 auto;
		padding: clamp(2rem, 4.2vw, 4rem) 0 clamp(2rem, 4vw, 4rem);
	}

	@media (max-width: 720px) {
		.frame {
			padding: 0.5rem;
		}

		.panel {
			border-radius: var(--radius-md);
			border-width: 2px;
		}

		.panel-main {
			width: calc(100% - 1rem);
			padding-top: 1.25rem;
		}
	}
</style>
